<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì „í™”ë²ˆí˜¸ ìˆ˜ì§‘ ê´€ë¦¬ì</title>
    
    <!-- ìºì‹œ ë¬´íš¨í™” -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    
    <!-- CSS ë²„ì „ ê´€ë¦¬ (timestampë¡œ ìºì‹œ ë°©ì§€) -->
    <link rel="stylesheet" href="styles/admin.css?v=1.1.0">
    
    <!-- ë²„ì „ ì²´í¬ ìŠ¤í¬ë¦½íŠ¸ (ê°€ì¥ ë¨¼ì € ë¡œë“œ) -->
    <script src="js/version.js"></script>
</head>
<body>
    <div class="container">
        <!-- ì¢Œì¸¡: ì„¸ì…˜ ê´€ë¦¬ ì‚¬ì´ë“œë°” -->
        <aside class="session-sidebar">
            <!-- ì„¸ì…˜ ë¹ ë¥¸ ì¶”ê°€ -->
            <div class="session-quick-add">
                <h3>ğŸ”¢ ìƒˆ ì„¸ì…˜ ì¶”ê°€</h3>
                <form id="quickAddForm" class="quick-form">
                    <input 
                        type="text" 
                        id="quickPinInput" 
                        name="pin" 
                        pattern="\d{4}"
                        maxlength="4"
                        placeholder="PIN 4ìë¦¬"
                        inputmode="numeric"
                        autocomplete="off"
                    >
                    <button type="submit" class="btn-quick-add">â•</button>
                </form>
                <div id="quickPinValidation" class="quick-validation"></div>
            </div>

            <!-- ì„¸ì…˜ ëª©ë¡ -->
            <div class="session-list-compact">
                <div class="session-list-header">
                    <h3>ğŸ“‹ ì„¸ì…˜ ëª©ë¡</h3>
                    <span id="sessionCount" class="session-count">0</span>
                </div>
                <div id="sessionListContainer" class="session-items">
                    <div class="session-loading">ì„¸ì…˜ ë¡œë”©ì¤‘...</div>
                </div>
            </div>
        </aside>

        <!-- ì¤‘ì•™: ë°ì´í„° í…Œì´ë¸” -->
        <div class="data-section">
            <!-- ë°ì´í„° í…Œì´ë¸” í—¤ë” -->
            <div class="header-row">
                <h1>ìˆ˜ì§‘ëœ ì „í™”ë²ˆí˜¸ <span id="realTimeIndicator" class="real-time-indicator" title="ì‹¤ì‹œê°„ ë™ê¸°í™” í™œì„±í™”"></span></h1>
            </div>
            
            <!-- ì„ íƒëœ ì„¸ì…˜ ì •ë³´ -->
            <div class="session-info-display">
                <div id="sessionInfo" class="session-info-badge"></div>
            </div>
            
            <div class="stats">
                <div class="stat-item">
                    <span class="stat-label">ì´ ìˆ˜ì§‘:</span>
                    <span class="stat-number" id="totalCount">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">ì˜¤ëŠ˜ ìˆ˜ì§‘:</span>
                    <span class="stat-number" id="todayCount">0</span>
                </div>
            </div>
            
            <div class="actions">
                <button id="exportBtn" class="btn btn-primary" title="í´ë¦­: Excel CSV ë‚´ë³´ë‚´ê¸° | Shift+í´ë¦­: ë‹¤ë¥¸ í˜•ì‹ ì„ íƒ">ë°ì´í„° ë‚´ë³´ë‚´ê¸°</button>
                <button id="clearBtn" class="btn btn-danger">ë°ì´í„° ì´ˆê¸°í™”</button>
                <button id="refreshBtn" class="btn btn-secondary" onclick="refreshAdminData()">ë°ì´í„° ìƒˆë¡œê³ ì¹¨</button>
            </div>
            
            <div class="table-container">
                <div class="table-scroll">
                    <table id="dataTable">
                        <thead>
                            <tr>
                                <th>ë²ˆí˜¸</th>
                                <th>ì´ë¦„</th>
                                <th>ì „í™”ë²ˆí˜¸</th>
                                <th>ìˆ˜ì§‘ì‹œê°„</th>
                            </tr>
                        </thead>
                        <tbody id="dataTableBody">
                            <!-- ë°ì´í„°ê°€ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <!-- ìš°ì¸¡: QRì½”ë“œ -->
        <div class="qr-section">
            <h2>QRì½”ë“œ ìŠ¤ìº”</h2>
            
            <!-- ì„¸ì…˜ ë¯¸ì„ íƒ ìƒíƒœ -->
            <div id="qrNoSession" class="qr-no-session" style="display: none;">
                <div class="empty-qr-icon">ğŸ“Œ</div>
                <h3>ì„¸ì…˜ì„ ì„ íƒí•˜ì„¸ìš”</h3>
                <p>ì¢Œì¸¡ì—ì„œ ì„¸ì…˜ì„ ì„ íƒí•˜ê±°ë‚˜<br>ìƒˆ PINì„ ì…ë ¥í•˜ì—¬ ì„¸ì…˜ì„ ì¶”ê°€í•˜ì„¸ìš”</p>
            </div>
            
            <div class="qr-container" id="qrContainer">
                    <div id="qrDisplay" style="text-align: center; padding: 20px;">
                        <img id="qrImage" src="" alt="QR Code" style="display: block;">
                        
                        <div id="qrLoading" style="display: none; padding: 20px;">
                            <div style="font-size: 18px; color: #3b82f6; margin-bottom: 10px;">ğŸ”„</div>
                            <p style="color: #666;">QRì½”ë“œ ìƒì„± ì¤‘...</p>
                        </div>
                        
                        <div id="qrFallback" style="border: 2px solid #3b82f6; border-radius: 12px; padding: 20px; background: #f8fafc; display: none;">
                            <div style="margin-bottom: 15px;">
                                <h3 style="color: #3b82f6; margin-bottom: 10px; font-size: 18px;">ğŸ“± ëª¨ë°”ì¼ ì•± ì ‘ì†</h3>
                                <p style="color: #666; font-size: 14px;">ì•„ë˜ ë§í¬ë¥¼ í´ë¦­í•˜ê±°ë‚˜ URLì„ ë³µì‚¬í•˜ì„¸ìš”</p>
                            </div>
                            
                            <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px; border: 1px solid #e5e7eb;">
                                <p style="font-size: 12px; word-break: break-all; color: #1f2937; margin-bottom: 10px;" id="fallbackUrl"></p>
                                <a href="" id="directLink" target="_blank" style="color: #3b82f6; text-decoration: none; font-weight: 600; font-size: 14px;">
                                    ğŸ”— ëª¨ë°”ì¼ ì•± ì—´ê¸°
                                </a>
                            </div>
                            
                            <div style="display: flex; gap: 10px; justify-content: center;">
                                <button onclick="copyUrl()" style="padding: 10px 20px; background: #3b82f6; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600;">
                                    ğŸ“‹ URL ë³µì‚¬
                                </button>
                                <button onclick="generateQR()" style="padding: 10px 20px; background: #10b981; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600;">
                                    ğŸ”„ QRì½”ë“œ ìƒì„±
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            <div class="qr-info">
                <p>ìœ„ QRì½”ë“œë¥¼ ìŠ¤ìº”í•˜ì—¬</p>
                <p>ì´ë¦„ê³¼ ì „í™”ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”</p>
            </div>
            <div class="url-display">
                <label>ëª¨ë°”ì¼ ì•± URL:</label>
                <input type="text" id="mobileUrl" readonly>
                <div style="display: flex; gap: 10px; margin-top: 10px;">
                    <button id="copyUrlBtn" class="btn btn-secondary">ë³µì‚¬</button>
                    <button id="refreshQrBtn" class="btn btn-secondary">QRì½”ë“œ ìƒˆë¡œê³ ì¹¨</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Supabase í´ë¼ì´ì–¸íŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.39.0/dist/umd/supabase.min.js"></script>
    <script src="js/supabase-config.js?v=1.1.0"></script>
    <script src="js/admin.js?v=1.1.0"></script>
    
    <script>
        // ì „ì—­ ë³€ìˆ˜
        let mobileUrl = '';
        
        // ì•± ì´ˆê¸°í™”
        function initApp() {
            console.log('ğŸš€ ì•± ì´ˆê¸°í™” ì‹œì‘');
            
            // ì´ˆê¸°ì—ëŠ” ì„¸ì…˜ì´ ì—†ìœ¼ë¯€ë¡œ QR ìˆ¨ê¹€
            const qrNoSession = document.getElementById('qrNoSession');
            const qrContainer = document.getElementById('qrContainer');
            
            if (qrNoSession) qrNoSession.style.display = 'flex';
            if (qrContainer) qrContainer.style.display = 'none';
            
            console.log('âš ï¸ ì´ˆê¸° ìƒíƒœ: QR ì½”ë“œ ìˆ¨ê¹€ (ì„¸ì…˜ ë¯¸ì„ íƒ)');
            
            // phoneManager ì¤€ë¹„ í›„ ë‹¤ì‹œ ì²´í¬
            setTimeout(() => {
                updateMobileUrl();
            }, 500);
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™” - DOMContentLoadedë¡œ ë” ë¹¨ë¦¬ ì‹œì‘
        document.addEventListener('DOMContentLoaded', function() {
            initApp();
        });
        
        // ë°±ì—…ìœ¼ë¡œ window.loadë„ ì‚¬ìš©
        window.addEventListener('load', function() {
            if (!mobileUrl) {
                initApp();
            }
        });
        
        // ëª¨ë°”ì¼ URL ìƒì„± (ì„¸ì…˜ ì„ íƒ ì‹œ í˜¸ì¶œ)
        function updateMobileUrl() {
            console.log('ğŸ“± ëª¨ë°”ì¼ URL ì—…ë°ì´íŠ¸');
            
            let pin = '';
            
            // phoneManagerì˜ currentSessionId ìš°ì„  í™•ì¸
            if (window.phoneManager && window.phoneManager.currentSessionId && window.phoneManager.sessions) {
                const session = window.phoneManager.sessions.find(s => s.id === window.phoneManager.currentSessionId);
                if (session) {
                    pin = session.pin;
                    console.log('ğŸ“Œ í˜„ì¬ ì„ íƒëœ ì„¸ì…˜ PIN:', pin);
                }
            }
            
            // ë“œë¡­ë‹¤ìš´ì—ì„œë„ í™•ì¸ (ë°±ì—…)
            if (!pin) {
                const sessionSelect = document.getElementById('sessionSelect');
                const selectedSessionId = sessionSelect ? sessionSelect.value : null;
                
                if (selectedSessionId && window.phoneManager && window.phoneManager.sessions) {
                    const session = window.phoneManager.sessions.find(s => s.id === parseInt(selectedSessionId));
                    if (session) {
                        pin = session.pin;
                        console.log('ğŸ“Œ ë“œë¡­ë‹¤ìš´ì—ì„œ ì„¸ì…˜ PIN:', pin);
                    }
                }
            }
            
            // QR ì½”ë“œ í‘œì‹œ/ìˆ¨ê¹€ ì œì–´
            const qrNoSession = document.getElementById('qrNoSession');
            const qrContainer = document.getElementById('qrContainer');
            
            if (!pin) {
                // ì„¸ì…˜ì´ ì„ íƒë˜ì§€ ì•ŠìŒ - QR ìˆ¨ê¸°ê³  ì•ˆë‚´ ë©”ì‹œì§€ í‘œì‹œ
                console.log('âš ï¸ ì„¸ì…˜ì´ ì„ íƒë˜ì§€ ì•ŠìŒ - QR ìˆ¨ê¹€');
                if (qrNoSession) qrNoSession.style.display = 'flex';
                if (qrContainer) qrContainer.style.display = 'none';
                return; // QR ìƒì„±í•˜ì§€ ì•ŠìŒ
            } else {
                // ì„¸ì…˜ ì„ íƒë¨ - QR í‘œì‹œ
                console.log('âœ… ì„¸ì…˜ ì„ íƒë¨ - QR í‘œì‹œ');
                if (qrNoSession) qrNoSession.style.display = 'none';
                if (qrContainer) qrContainer.style.display = 'block';
            }
            
            // URL ì„¤ì • - GitHub Pages í˜¸í™˜
            const protocol = window.location.protocol;
            const hostname = window.location.hostname;
            const port = window.location.port;
            const portString = port ? `:${port}` : '';
            
            // í˜„ì¬ ê²½ë¡œì—ì„œ ê¸°ë³¸ ê²½ë¡œ ì¶”ì¶œ
            const currentPath = window.location.pathname;
            let basePath = '';
            
            // GitHub Pagesì¸ ê²½ìš° ê²½ë¡œ ì²˜ë¦¬
            if (hostname.includes('github.io')) {
                // /getphnum/ ê°™ì€ ì„œë¸Œë””ë ‰í† ë¦¬ì—ì„œ ì‹¤í–‰ ì¤‘ì¸ ê²½ìš°
                const pathParts = currentPath.split('/').filter(part => part);
                if (pathParts.length > 0) {
                    basePath = '/' + pathParts[0] + '/';
                } else {
                    basePath = '/';
                }
            } else if (portString) {
                // ë¡œì»¬ ê°œë°œ í™˜ê²½
                basePath = '/';
            } else {
                // ì¼ë°˜ ì›¹ì„œë²„
                basePath = '/';
            }
            
            // PINì´ ìˆìœ¼ë©´ URLì— ì¶”ê°€
            if (pin) {
                mobileUrl = `${protocol}//${hostname}${portString}${basePath}mobile.html?pin=${pin}`;
            } else {
                mobileUrl = `${protocol}//${hostname}${portString}${basePath}mobile.html`;
            }
            
            console.log('ğŸ“± ëª¨ë°”ì¼ URL ì„¤ì •:', mobileUrl);
            console.log('í˜„ì¬ ê²½ë¡œ:', currentPath);
            console.log('ê¸°ë³¸ ê²½ë¡œ:', basePath);
            console.log('PIN:', pin || 'ì—†ìŒ');
            
            // UI ìš”ì†Œ ì—…ë°ì´íŠ¸
            updateUI();
            
            // QRì½”ë“œ ìƒì„± ì‹œë„ (ì•½ê°„ì˜ ì§€ì—° í›„)
            setTimeout(() => {
                generateQR();
            }, 100);
        }
        
        // ì „ì—­ í•¨ìˆ˜ë¡œ ë…¸ì¶œ (ì„¸ì…˜ ë³€ê²½ ì‹œ í˜¸ì¶œìš©)
        window.updateMobileUrl = updateMobileUrl;
        
        // UI ì—…ë°ì´íŠ¸
        function updateUI() {
            const urlInput = document.getElementById('mobileUrl');
            const fallbackUrl = document.getElementById('fallbackUrl');
            const directLink = document.getElementById('directLink');
            
            urlInput.value = mobileUrl;
            fallbackUrl.textContent = mobileUrl;
            directLink.href = mobileUrl;
        }
        
        // QRì½”ë“œ ìƒì„±
        function generateQR() {
            const qrImage = document.getElementById('qrImage');
            const qrFallback = document.getElementById('qrFallback');
            const qrLoading = document.getElementById('qrLoading');
            
            console.log('QRì½”ë“œ ìƒì„± ì‹œë„...');
            console.log('í˜„ì¬ URL:', mobileUrl);
            console.log('í˜„ì¬ hostname:', window.location.hostname);
            
            // ë¡œë”© ìƒíƒœ í‘œì‹œ
            qrImage.style.display = 'none';
            qrFallback.style.display = 'none';
            qrLoading.style.display = 'block';
            
            // ë‹¤ì¤‘ QR API ì‹œë„
            const qrApis = [
                `https://chart.googleapis.com/chart?chs=300x300&cht=qr&chl=${encodeURIComponent(mobileUrl)}`,
                `https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=${encodeURIComponent(mobileUrl)}`,
                `https://qr-code-styling.com/qr_code?data=${encodeURIComponent(mobileUrl)}&size=300`
            ];
            
            // í™•ì¥ìš© QR API (ë” í° í¬ê¸°)
            const qrApisExpanded = [
                `https://chart.googleapis.com/chart?chs=400x400&cht=qr&chl=${encodeURIComponent(mobileUrl)}`,
                `https://api.qrserver.com/v1/create-qr-code/?size=400x400&data=${encodeURIComponent(mobileUrl)}`,
                `https://qr-code-styling.com/qr_code?data=${encodeURIComponent(mobileUrl)}&size=400`
            ];
            
            let currentApiIndex = 0;
            
            function tryNextQrApi() {
                if (currentApiIndex >= qrApis.length) {
                    // ëª¨ë“  API ì‹¤íŒ¨
                    console.log('âŒ ëª¨ë“  QR API ì‹¤íŒ¨');
                    qrLoading.style.display = 'none';
                    qrImage.style.display = 'none';
                    qrFallback.style.display = 'block';
                    
                    if (window.location.hostname === 'localhost' || 
                        window.location.hostname === '127.0.0.1' || 
                        window.location.protocol === 'file:') {
                        showLocalInfo();
                    } else {
                        showGeneralFallback();
                    }
                    return;
                }
                
                const currentUrl = qrApis[currentApiIndex];
                console.log(`QR API ì‹œë„ ${currentApiIndex + 1}/${qrApis.length}:`, currentUrl);
                
                // íƒ€ì„ì•„ì›ƒ ì„¤ì • (2ì´ˆ)
                const timeout = setTimeout(() => {
                    console.log(`QR API ${currentApiIndex + 1} íƒ€ì„ì•„ì›ƒ`);
                    currentApiIndex++;
                    tryNextQrApi();
                }, 2000);
                
                qrImage.onload = function() {
                    clearTimeout(timeout);
                    console.log('âœ… QRì½”ë“œ ìƒì„± ì„±ê³µ!');
                    qrLoading.style.display = 'none';
                    qrImage.style.display = 'block';
                    qrFallback.style.display = 'none';
                };
                
                qrImage.onerror = function() {
                    clearTimeout(timeout);
                    console.log(`âŒ QR API ${currentApiIndex + 1} ì‹¤íŒ¨`);
                    currentApiIndex++;
                    tryNextQrApi();
                };
                
                qrImage.src = currentUrl;
            }
            
            // ì²« ë²ˆì§¸ API ì‹œë„
            tryNextQrApi();
        }
        
        // ë¡œì»¬ í™˜ê²½ ì •ë³´ í‘œì‹œ
        function showLocalInfo() {
            const qrImage = document.getElementById('qrImage');
            const qrFallback = document.getElementById('qrFallback');
            
            qrImage.style.display = 'none';
            qrFallback.style.display = 'block';
            
            // ë¡œì»¬ í™˜ê²½ìš© ì•ˆë‚´ ì—…ë°ì´íŠ¸
            const fallbackDiv = document.getElementById('qrFallback');
            fallbackDiv.innerHTML = `
                <div style="border: 2px solid #f59e0b; border-radius: 12px; padding: 20px; background: #fffbeb;">
                    <div style="margin-bottom: 15px;">
                        <h3 style="color: #f59e0b; margin-bottom: 10px; font-size: 18px;">ğŸ  ë¡œì»¬ í™˜ê²½ì—ì„œ ì‹¤í–‰ ì¤‘</h3>
                        <p style="color: #666; font-size: 14px;">QRì½”ë“œëŠ” ì›¹ì„œë²„ì— ë°°í¬ í›„ ìƒì„±ë©ë‹ˆë‹¤</p>
                    </div>
                    
                    <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px; border: 1px solid #fbbf24;">
                        <p style="font-size: 14px; margin-bottom: 10px; font-weight: 600;">í…ŒìŠ¤íŠ¸ ë°©ë²•:</p>
                        <p style="font-size: 12px; word-break: break-all; color: #1f2937; margin-bottom: 10px;">${mobileUrl}</p>
                        <p style="font-size: 12px; color: #666;">
                            ğŸ“± ê°™ì€ ë„¤íŠ¸ì›Œí¬ì˜ ìŠ¤ë§ˆíŠ¸í°ì—ì„œ ìœ„ URLë¡œ ì ‘ì†í•˜ì„¸ìš”<br>
                            (ì»´í“¨í„°ì™€ ìŠ¤ë§ˆíŠ¸í°ì´ ê°™ì€ WiFiì— ì—°ê²°ë˜ì–´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤)
                        </p>
                    </div>
                    
                    <div style="background: #f0f9ff; padding: 15px; border-radius: 8px; margin-bottom: 15px; border: 1px solid #0ea5e9;">
                        <p style="font-size: 14px; margin-bottom: 8px; font-weight: 600; color: #0369a1;">ğŸ’¡ ë°°í¬ í›„ QRì½”ë“œ ìƒì„±ë©ë‹ˆë‹¤:</p>
                        <p style="font-size: 12px; color: #0369a1;">
                            â€¢ GitHub Pages<br>
                            â€¢ Netlify<br>
                            â€¢ Vercel<br>
                            â€¢ ì›¹ í˜¸ìŠ¤íŒ… ì„œë¹„ìŠ¤
                        </p>
                    </div>
                    
                    <div style="display: flex; gap: 10px; justify-content: center;">
                        <button onclick="copyUrl()" style="padding: 10px 20px; background: #f59e0b; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600;">
                            ğŸ“‹ URL ë³µì‚¬
                        </button>
                        <button onclick="showNetworkIP()" style="padding: 10px 20px; background: #0ea5e9; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600;">
                            ğŸŒ ë„¤íŠ¸ì›Œí¬ IP í™•ì¸
                        </button>
                    </div>
                </div>
            `;
        }
        
        // ì¼ë°˜ì ì¸ ëŒ€ì²´ ë°©ë²• í‘œì‹œ
        function showGeneralFallback() {
            const fallbackDiv = document.getElementById('qrFallback');
            fallbackDiv.innerHTML = `
                <div style="border: 2px solid #ef4444; border-radius: 12px; padding: 20px; background: #fef2f2;">
                    <div style="margin-bottom: 15px;">
                        <h3 style="color: #ef4444; margin-bottom: 10px; font-size: 18px;">âš ï¸ QRì½”ë“œ ìƒì„± ì‹¤íŒ¨</h3>
                        <p style="color: #666; font-size: 14px;">ë„¤íŠ¸ì›Œí¬ ë¬¸ì œë¡œ QRì½”ë“œë¥¼ ìƒì„±í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤</p>
                    </div>
                    
                    <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px; border: 1px solid #e5e7eb;">
                        <p style="font-size: 12px; word-break: break-all; color: #1f2937; margin-bottom: 10px;">${mobileUrl}</p>
                        <a href="${mobileUrl}" target="_blank" style="color: #3b82f6; text-decoration: none; font-weight: 600; font-size: 14px;">
                            ğŸ”— ëª¨ë°”ì¼ ì•± ì—´ê¸°
                        </a>
                    </div>
                    
                    <div style="display: flex; gap: 10px; justify-content: center;">
                        <button onclick="copyUrl()" style="padding: 10px 20px; background: #3b82f6; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600;">
                            ğŸ“‹ URL ë³µì‚¬
                        </button>
                        <button onclick="generateQR()" style="padding: 10px 20px; background: #10b981; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600;">
                            ğŸ”„ ë‹¤ì‹œ ì‹œë„
                        </button>
                    </div>
                </div>
            `;
        }
        
        // ë„¤íŠ¸ì›Œí¬ IP ì •ë³´ í‘œì‹œ
        function showNetworkIP() {
            const networkInfo = `
í˜„ì¬ localhostë¡œ ì‹¤í–‰ ì¤‘ì…ë‹ˆë‹¤.

ìŠ¤ë§ˆíŠ¸í°ì—ì„œ í…ŒìŠ¤íŠ¸í•˜ë ¤ë©´:
1. ì»´í“¨í„°ì˜ IP ì£¼ì†Œë¥¼ í™•ì¸í•˜ì„¸ìš”
2. localhostë¥¼ í•´ë‹¹ IPë¡œ ë°”ê¿”ì„œ ì ‘ì†í•˜ì„¸ìš”

ì˜ˆì‹œ:
- í˜„ì¬: ${mobileUrl}
- ë³€ê²½: http://192.168.1.100:í¬íŠ¸ë²ˆí˜¸/mobile.html

IP í™•ì¸ ë°©ë²•:
â€¢ Windows: cmdì—ì„œ 'ipconfig' ì‹¤í–‰
â€¢ Mac/Linux: í„°ë¯¸ë„ì—ì„œ 'ifconfig' ì‹¤í–‰
â€¢ ë˜ëŠ” ì‹œìŠ¤í…œ ì„¤ì •ì—ì„œ ë„¤íŠ¸ì›Œí¬ ì •ë³´ í™•ì¸
            `;
            
            alert(networkInfo);
        }
        
        // URL ë³µì‚¬
        function copyUrl() {
            const urlInput = document.getElementById('mobileUrl');
            
            // í´ë¦½ë³´ë“œ API ì‚¬ìš©
            if (navigator.clipboard) {
                navigator.clipboard.writeText(mobileUrl).then(() => {
                    showMessage('URLì´ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤! ğŸ“‹');
                }).catch(() => {
                    fallbackCopy();
                });
            } else {
                fallbackCopy();
            }
        }
        
        // ëŒ€ì²´ ë³µì‚¬ ë°©ë²•
        function fallbackCopy() {
            const urlInput = document.getElementById('mobileUrl');
            urlInput.select();
            urlInput.setSelectionRange(0, 99999);
            
            try {
                document.execCommand('copy');
                showMessage('URLì´ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤! ğŸ“‹');
            } catch (err) {
                showMessage('URLì„ ìˆ˜ë™ìœ¼ë¡œ ë³µì‚¬í•´ì£¼ì„¸ìš”: ' + mobileUrl);
            }
        }
        
        // ë©”ì‹œì§€ í‘œì‹œ
        function showMessage(text) {
            // ê¸°ì¡´ ë©”ì‹œì§€ ì œê±°
            const existingMsg = document.getElementById('copyMessage');
            if (existingMsg) {
                existingMsg.remove();
            }
            
            // ìƒˆ ë©”ì‹œì§€ ìƒì„±
            const message = document.createElement('div');
            message.id = 'copyMessage';
            message.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: #10b981;
                color: white;
                padding: 12px 20px;
                border-radius: 8px;
                font-weight: 600;
                z-index: 1000;
                animation: slideIn 0.3s ease;
            `;
            message.textContent = text;
            
            document.body.appendChild(message);
            
            // 3ì´ˆ í›„ ì œê±°
            setTimeout(() => {
                if (message.parentNode) {
                    message.remove();
                }
            }, 3000);
        }
        
        // CSS ì• ë‹ˆë©”ì´ì…˜ ì¶”ê°€
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from {
                    transform: translateX(100%);
                    opacity: 0;
                }
                to {
                    transform: translateX(0);
                    opacity: 1;
                }
            }
        `;
        document.head.appendChild(style);
        
        
        // ì „ì—­ ìƒˆë¡œê³ ì¹¨ í•¨ìˆ˜ (ë°±ì—…)
        if (typeof refreshAdminData === 'undefined') {
            window.refreshAdminData = function() {
                console.log('ì „ì—­ ìƒˆë¡œê³ ì¹¨ í•¨ìˆ˜ í˜¸ì¶œ');
                location.reload();
            };
        }
        
        // ë¡œì»¬ í™˜ê²½ì—ì„œ ê¸°ì¡´ Service Worker ì •ë¦¬
        if ((window.location.hostname.includes('localhost') || window.location.hostname.includes('127.0.0.1')) && 'serviceWorker' in navigator) {
            navigator.serviceWorker.getRegistrations().then(function(registrations) {
                for(let registration of registrations) {
                    console.log('ğŸ§¹ ê¸°ì¡´ Service Worker ì œê±°:', registration.scope);
                    registration.unregister();
                }
            }).catch(function(error) {
                console.log('Service Worker ì œê±° ì¤‘ ì˜¤ë¥˜:', error);
            });
        }
    </script>
</body>
</html>
